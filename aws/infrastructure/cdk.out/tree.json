{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.214.0"},"children":{"CoralEmailStack":{"id":"CoralEmailStack","path":"CoralEmailStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.214.0"},"children":{"EmailFunctionLogs":{"id":"EmailFunctionLogs","path":"CoralEmailStack/EmailFunctionLogs","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoralEmailStack/EmailFunctionLogs/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"retentionInDays":7}}}}},"EmailHandler":{"id":"EmailHandler","path":"CoralEmailStack/EmailHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.214.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"CoralEmailStack/EmailHandler/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CoralEmailStack/EmailHandler/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}},"Resource":{"id":"Resource","path":"CoralEmailStack/EmailHandler/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CoralEmailStack/EmailHandler/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoralEmailStack/EmailHandler/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ses:SendEmail","ses:SendRawEmail","xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"EmailHandlerServiceRoleDefaultPolicy897B1A65","roles":[{"Ref":"EmailHandlerServiceRole5532AF63"}]}}}}}}},"Code":{"id":"Code","path":"CoralEmailStack/EmailHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.214.0"},"children":{"Stage":{"id":"Stage","path":"CoralEmailStack/EmailHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"AssetBucket":{"id":"AssetBucket","path":"CoralEmailStack/EmailHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.214.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"CoralEmailStack/EmailHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["arm64"],"code":{"s3Bucket":"cdk-hnb659fds-assets-555030775244-eu-central-1","s3Key":"965898f1272347b177f26318798e5a2c90d93339176ddc136e4d429290976cbe.zip"},"environment":{"variables":{"NODE_OPTIONS":"--enable-source-maps","AWS_NODEJS_CONNECTION_REUSE_ENABLED":"1"}},"handler":"index.handler","layers":["arn:aws:lambda:eu-central-1:580247275435:layer:LambdaInsightsExtension-Arm64:22"],"loggingConfig":{"logGroup":{"Ref":"EmailFunctionLogs9F0F5F41"}},"memorySize":256,"role":{"Fn::GetAtt":["EmailHandlerServiceRole5532AF63","Arn"]},"runtime":"nodejs16.x","timeout":10,"tracingConfig":{"mode":"Active"}}}},"LambdaInsightsLayer":{"id":"LambdaInsightsLayer","path":"CoralEmailStack/EmailHandler/LambdaInsightsLayer","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}}}},"EmailApi":{"id":"EmailApi","path":"CoralEmailStack/EmailApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpApi","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoralEmailStack/EmailApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"corsConfiguration":{"allowHeaders":["Content-Type","Authorization"],"allowMethods":["GET","POST","OPTIONS"],"allowOrigins":["http://angular.coralworld.eu","http://localhost:3000"],"maxAge":864000},"description":"Coral Club Contact Form API","name":"EmailApi","protocolType":"HTTP"}}},"DefaultStage":{"id":"DefaultStage","path":"CoralEmailStack/EmailApi/DefaultStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoralEmailStack/EmailApi/DefaultStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"EmailApi51CACE34"},"autoDeploy":true,"stageName":"$default"}}}}},"POST--contact":{"id":"POST--contact","path":"CoralEmailStack/EmailApi/POST--contact","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.214.0","metadata":[]},"children":{"EmailIntegration":{"id":"EmailIntegration","path":"CoralEmailStack/EmailApi/POST--contact/EmailIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoralEmailStack/EmailApi/POST--contact/EmailIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"EmailApi51CACE34"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["EmailHandler7CB4CA8F","Arn"]},"payloadFormatVersion":"2.0"}}}}},"EmailIntegration-Permission":{"id":"EmailIntegration-Permission","path":"CoralEmailStack/EmailApi/POST--contact/EmailIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EmailHandler7CB4CA8F","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:eu-central-1:555030775244:",{"Ref":"EmailApi51CACE34"},"/*/*/contact"]]}}}},"Resource":{"id":"Resource","path":"CoralEmailStack/EmailApi/POST--contact/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"EmailApi51CACE34"},"authorizationType":"NONE","routeKey":"POST /contact","target":{"Fn::Join":["",["integrations/",{"Ref":"EmailApiPOSTcontactEmailIntegration9F562C0F"}]]}}}}}}}},"EmailApiAccessLogs":{"id":"EmailApiAccessLogs","path":"CoralEmailStack/EmailApiAccessLogs","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoralEmailStack/EmailApiAccessLogs/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"retentionInDays":7}}}}},"ProdStage":{"id":"ProdStage","path":"CoralEmailStack/ProdStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.214.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoralEmailStack/ProdStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"accessLogSettings":{"destinationArn":{"Fn::GetAtt":["EmailApiAccessLogsB49BC222","Arn"]},"format":"{\"requestId\":\"$context.requestId\",\"sourceIp\":\"$context.identity.sourceIp\",\"method\":\"$context.httpMethod\",\"userContext\":{\"sub\":\"$context.authorizer.claims.sub\",\"email\":\"$context.authorizer.claims.email\"}}"},"apiId":{"Ref":"EmailApi51CACE34"},"autoDeploy":true,"stageName":"prod"}}}}},"ApiUrl":{"id":"ApiUrl","path":"CoralEmailStack/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.214.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CoralEmailStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"CoralEmailStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CoralEmailStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.214.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CoralEmailStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.214.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}